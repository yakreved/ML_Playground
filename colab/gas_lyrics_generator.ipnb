{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "view-in-github",
        "colab_type": "text"
      },
      "source": [
        "<a href=\"https://colab.research.google.com/github/yakreved/ML_Playground/blob/main/colab/gas_lyrics_generator.ipnb\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Сделано на основе https://colab.sandbox.google.com/github/tensorflow/examples/blob/master/courses/udacity_intro_to_tensorflow_for_deep_learning/l10c04_nlp_optimizing_the_text_generation_model.ipynb"
      ],
      "metadata": {
        "id": "ILxfzLKBA5xI"
      }
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "Ph5eir3Pf-3z"
      },
      "source": [
        "# Optimizing the Text Generation Model"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "S5Uhzt6vVIB2"
      },
      "source": [
        "<table class=\"tfo-notebook-buttons\" align=\"left\">\n",
        "  <td>\n",
        "    <a target=\"_blank\" href=\"https://colab.research.google.com/github/tensorflow/examples/blob/master/courses/udacity_intro_to_tensorflow_for_deep_learning/l10c04_nlp_optimizing_the_text_generation_model.ipynb\"><img src=\"https://www.tensorflow.org/images/colab_logo_32px.png\" />Run in Google Colab</a>\n",
        "  </td>\n",
        "  <td>\n",
        "    <a target=\"_blank\" href=\"https://github.com/tensorflow/examples/blob/master/courses/udacity_intro_to_tensorflow_for_deep_learning/l10c04_nlp_optimizing_the_text_generation_model.ipynb\"><img src=\"https://www.tensorflow.org/images/GitHub-Mark-32px.png\" />View source on GitHub</a>\n",
        "  </td>\n",
        "</table>"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "dCxhW3mtLmfb"
      },
      "source": [
        "You've already done some amazing work with generating new songs, but so far we've seen some issues with repetition and a fair amount of incoherence. By using more data and further tweaking the model, you'll be able to get improved results. We'll once again use the [Kaggle Song Lyrics Dataset](https://www.kaggle.com/mousehead/songlyrics) here."
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "4aHK2CYygXom"
      },
      "source": [
        "## Import TensorFlow and related functions"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 4,
      "metadata": {
        "id": "2LmLTREBf5ng"
      },
      "outputs": [],
      "source": [
        "import tensorflow as tf\n",
        "\n",
        "from tensorflow.keras.preprocessing.text import Tokenizer\n",
        "from tensorflow.keras.preprocessing.sequence import pad_sequences\n",
        "\n",
        "# Other imports for processing data\n",
        "import string\n",
        "import numpy as np\n",
        "import pandas as pd"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "GmLTO_dpgge9"
      },
      "source": [
        "## Get the Dataset\n",
        "\n",
        "As noted above, we'll utilize the [Song Lyrics dataset](https://www.kaggle.com/mousehead/songlyrics) on Kaggle again."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "4Bf5FVHfganK"
      },
      "outputs": [],
      "source": [
        "!wget --no-check-certificate \\\n",
        "    https://drive.google.com/uc?id=1LiJFZd41ofrWoBtW-pMYsfz1w8Ny0Bj8 \\\n",
        "    -O /tmp/songdata.csv"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Нет! Мы нафигачим сюда текстов Сектора газа!"
      ],
      "metadata": {
        "id": "sIWhZ4uwAjLr"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "song_1 = '''С матершиной мы родились,\n",
        "C матершиной мы живём,\n",
        "С матершиной мы учились,\n",
        "C матершиной и помрём,\n",
        "Матершину мы вкушали\n",
        "C материнским молоком,\n",
        "С матершиной мой папаша\n",
        "Бил мамашу кулаком.\n",
        "\n",
        "Вы не ждите, что в припеве\n",
        "Заругаюсь матом я,\n",
        "Я б, конечно, заругался,\n",
        "Только очередь твоя!\n",
        "И подкалывать не надо,\n",
        "Мне на это наплевать,\n",
        "Матершинные слова\n",
        "Не буду я употреблять!\n",
        "\n",
        "Матом кроют генералы,\n",
        "Матом кроют продавцы,\n",
        "Матом кроют прокуроры\n",
        "И родные отцы.\n",
        "Все, как будто бы святые,\n",
        "А приди к любому в дом,\n",
        "Через каждые два слова\n",
        "Каждый ложит матюгом.\n",
        "\n",
        "Вы не ждите, что в припеве\n",
        "Заругаюсь матом я,\n",
        "Я б, конечно, заругался,\n",
        "Только очередь твоя!\n",
        "И подкалывать не надо,\n",
        "Мне на это наплевать,\n",
        "Матершинные слова\n",
        "Не буду я употреблять!\n",
        "Источник teksty-pesenok.ru\n",
        "\n",
        "Без русcкого мата\n",
        "Не прожить нам и дня,\n",
        "Отведи мою душу,\n",
        "Обложи ты меня,\n",
        "Матершиной нашей русcкой\n",
        "Обложи и не с*ы,\n",
        "Как учили нас деды,\n",
        "Как учили отцы.\n",
        "\n",
        "Вы не ждите, что в припеве\n",
        "Заругаюсь матом я,\n",
        "Я б, конечно, заругался,\n",
        "Только очередь твоя!\n",
        "И подкалывать не надо,\n",
        "Мне на это наплевать,\n",
        "Матершинные слова\n",
        "Не буду я употреблять\n",
        "'''\n",
        "\n",
        "song_2 = '''Был хорошо, было так легко,\n",
        "Но на шею бросили аркан,\n",
        "Солнечный огонь,\n",
        "Атмосферы бронь,\n",
        "Пробевал, но не пробил туман\n",
        "\n",
        "И мертвый месяц еле освещает путь,\n",
        "И звезды давят нам на грудь - не продохнуть,\n",
        "И воздух ядовит как ртуть,\n",
        "Нельзя свернуть, нельзя шагнуть,\n",
        "И не пройти нам этот путь в такой туман\n",
        "\n",
        "А куда шагнуть?\n",
        "Бог покажет путь,\n",
        "Бог для нас всегда бесплотный вождь,\n",
        "Нас бросает в дрожь, вдруг начался дождь,\n",
        "Нас добьет конкретный сильный дождь\n",
        "\n",
        "И месяц провоцирует нас на обман,\n",
        "И испарения земли бьет как дурман,\n",
        "И каждый пень нам как капкан,\n",
        "И хлещет кровь из наших ран,\n",
        "И не пройти нам этот путь в такй туман\n",
        "\n",
        "Все пошло на сдвиг, наша жизнь как миг,\n",
        "Коротка как юбка у путан,\n",
        "Нам все непочем через левое плечо, плюнем и пойдем через туман\n",
        "Источник teksty-pesenok.ru\n",
        "\n",
        "Пусть мертвый месяц еле освещает путь,\n",
        "\n",
        "Пусть звезды давят нам на грудь - не продохнуть,\n",
        "Пусть воздух ядовит как ртуть и пусть не видно где свернуть\n",
        "Но мы пройдем опасный путь через туман,\n",
        "\n",
        "Пусть месяц провоцирует нас на обман,\n",
        "Пусть испарение земли бьет как дурман,\n",
        "Пусть каждый пень нам как капкан ,\n",
        "Пусть хлещет кровь из наших ран,\n",
        "Но мы пройдем с тобою путь через туман\n",
        "Но мы пройдем с тобою путь через туман\n",
        "но мы пройдем опасный путь через туман\n",
        "'''\n",
        "\n",
        "song_3 = '''\n",
        "Я копаюсь на помойке, как червяк.\n",
        "С детства жизнь моя наперекосяк.\n",
        "Канализационный люк - моя дверь,\n",
        "Но я счастлив по-своему, поверь.\n",
        "Двадцать лет назад сгорел родной мой дом.\n",
        "Документы, деньги - все сгорело в нем.\n",
        "И теперь я побираюсь двадцать лет -\n",
        "Кому нужен старый, никудышный дед.\n",
        "\n",
        "А я бычок подниму, горький дым затяну,\n",
        "Покурю и полезу домо-ой.\n",
        "Не жалейте меня, я прекрасно живу,\n",
        "Только кушать охота порой.\n",
        "А я бычок подниму, горький дым затяну,\n",
        "Люк открою, полезу домо-ой.\n",
        "Не жалейте меня, я прекрасно живу,\n",
        "Только кушать охота порой.\n",
        "\n",
        "Эй, ребята, как допьете вы вино,\n",
        "Мне бутылки вы оставьте за одно.\n",
        "Пожалейте вы несчастного БОМЖу.\n",
        "Я их в сумку аккуратно положу.\n",
        "Отнесу я завтра их в приемный пункт.\n",
        "Мне за них 60 копеек отдадут.\n",
        "Я куплю буханку хлеба и сырок,\n",
        "Чтобы с голоду не протянуть мне ног.\n",
        "\n",
        "А я бычок подниму, горький дым затяну,\n",
        "Покурю и полезу домо-ой.\n",
        "Не жалейте меня, я прекрасно живу,\n",
        "Только кушать охота порой.\n",
        "А я бычок подниму, горький дым затяну,\n",
        "Люк открою, полезу домо-ой.\n",
        "Не жалейте меня, я прекрасно живу,\n",
        "Только кушать охота порой.\n",
        "\n",
        "Ах, подайте, люди, мне, ради Христа.\n",
        "Не мила мне жизнь, я от нее устал.\n",
        "Помоги, прохожий милый, пятаком,\n",
        "Сжалься надо мной, над бедным стариком.\n",
        "Ах, отпусти меня, товарищ старшина.\n",
        "Я простой советский БОМЖ, а не шпана.\n",
        "Я не сделал ведь плохого никому.\n",
        "Так за что меня берете, не пойму?\n",
        "\n",
        "А я бычок подниму, горький дым затяну,\n",
        "Покурю и полезу домо-ой.\n",
        "Не жалейте меня, я прекрасно живу,\n",
        "Только кушать охота порой.\n",
        "А я бычок подниму, горький дым затяну,\n",
        "Люк открою, полезу домо-ой.\n",
        "Не жалейте меня, я прекрасно живу,\n",
        "Только кушать охота порой.\n",
        "'''\n",
        "\n",
        "song_4 = '''Бери свою метлу, полетели на шабаш,\n",
        "Возьми с собой апокалипсис - символ наш:\n",
        "Сегодня настает вальпургиева ночь.\n",
        "Сегодня каждой твари будет не в мочь,\n",
        "Сегодня слуги дьявола хоронят свою дочь.\n",
        "Сегодня настает вальпургиева ночь.\n",
        "Сегодня настает вальпургиева ночь.\n",
        "Сегодня настает вальпургиева ночь.\n",
        "Преданы анафеме с тобою мы давно,\n",
        "Наше имя в черный список занесено.\n",
        "Сегодня настает вальпургиева ночь.\n",
        "Мы с ведьмами в ромашку поиграем в зту ночь,\n",
        "Мы изнас*луем похороненную дочь.\n",
        "Сегодня настает вальпургиева ночь.\n",
        "Сегодня настает вальпургиева ночь.\n",
        "Сегодня настает вальпургиева ночь.\n",
        "И пусть на нас не сердится папаша Люцифер,\n",
        "Мы перед ним чисты, без всяких афер.\n",
        "Сегодня настает вальпургиева ночь.\n",
        "Ведь утром, на рассвете, мы подожмем хвосты,\n",
        "А в полдень инквизиторы нас кинут на костры.\n",
        "Сегодня настает вальпургиева ночь.\n",
        "Сегодня настает вальпургиева ночь.\n",
        "Сегодня настает вальпургиева ночь.'''\n",
        "\n",
        "song_5 = '''Солнце осветило горизонт\n",
        "Утро оборвало мой сладкий сон\n",
        "Я проснулся я был поражён\n",
        "Ощутил годам урон\n",
        "Словно в первый раз я увидел свет\n",
        "Словно в первый раз я был им согрет\n",
        "Годы ощутил хоть я и не дед\n",
        "Мне сегодня тридцать лет\n",
        "\n",
        "В этот день родили меня на свет\n",
        "В этот день с иголочки я одет\n",
        "В этот день теплом вашим я согрет\n",
        "Мне сегодня тридцать лет\n",
        "В этот день скажу юности привет\n",
        "В этот день я в зрелость возьму билет\n",
        "В этот день и водка не во вред\n",
        "Мне сегодня тридцать лет\n",
        "\n",
        "Солнце наливаясь вошло в зенит\n",
        "Музыка в моих ушах звенит\n",
        "Не грусти и даже не делай вид\n",
        "Каждая нота мне говорит\n",
        "Я рукой нащупал свой карман\n",
        "Он мне намекнул что я буду пьян\n",
        "Говорит мне день держись братан\n",
        "Лучше протирай стакан\n",
        "\n",
        "В этот день родили меня на свет\n",
        "В этот день с иголочки я одет\n",
        "В этот день теплом вашим я согрет\n",
        "Мне сегодня 30 лет\n",
        "В этот день скажу юности привет\n",
        "В этот день я в зрелость возьму билет\n",
        "В этот день и водка не во вред\n",
        "Мне сегодня 30 лет\n",
        "\n",
        "Солнце опустилось за горизонт\n",
        "Дома у меня стаканов звон\n",
        "Собрались друзья со всех сторон\n",
        "Друг врубай магнитофон\n",
        "Я имею право сегодня пить\n",
        "Я имею право сегодня жить\n",
        "Я имею право про всё забыть\n",
        "Да чего там говорить\n",
        "\n",
        "В этот день родили меня на свет\n",
        "В этот день с иголочки я одет\n",
        "В этот день теплом вашим я согрет\n",
        "Мне сегодня тридцать лет\n",
        "В этот день скажу юности привет\n",
        "В этот день я в зрелость возьму билет\n",
        "В этот день и водка не во вред\n",
        "Мне сегодня тридцать лет\n",
        "Мне сегодня тридцать лет\n",
        "'''\n",
        "\n",
        "song_6 = '''Эй, подруга, выходи скорей во двор.\n",
        "Я специально для тебя гитару припер.\n",
        "Я сыграю для тебя на аккордах на блатных.\n",
        "Ну а коль не выйдешь ты, то получишь под дых.\n",
        "Возле дома твоего-о, возле дома твоего.\n",
        "Возле дома твоего-а, возле дома твоего.\n",
        "\n",
        "Эй, подруга, выходи-ка на крыльцо.\n",
        "И не слушай ругань матерную матери с отцом.\n",
        "Я тебя аккуратно к сеновалу отнесу.\n",
        "Ну а коль не выйдешь ты, все заборы обоссу.\n",
        "\n",
        "Возле дома твоего-о, возле дома твоего.\n",
        "Возле дома твоего-а, возле дома твоего.\n",
        "\n",
        "Эй, залетка, выходи послушать рок.\n",
        "Я специально для тебя магнитолу приволок.\n",
        "Ну а коль не выйдешь ты, то учти, ядрена медь:\n",
        "На весь хутор под гитару песни матом буду пе-е-е-ть.\n",
        "\n",
        "Возле дома твоего-о, возле дома твоего.\n",
        "Возле дома твоего-а, возле дома твоего-а-а-а-а-а\n",
        "'''\n",
        "\n",
        "song_7 = '''Скорый поезд к дому мчится.\n",
        "Полечу домой как птица,\n",
        "Полечу как птица я!\n",
        "Жизнь начнётся без авралов,\n",
        "Сундуков и генералов\n",
        "Демобилизация! - 2х\n",
        "Я приеду к тебе вскоре,\n",
        "Будет спать спокойно город\n",
        "В клёнах и акациях.\n",
        "Я прижмусь к тебе щекою,\n",
        "Ты смахнешь слезу рукою.\n",
        "Демобилизация!\n",
        "И пройдёмся под луною,\n",
        "Рядом с будущей женою,\n",
        "Каблучками цокая!\n",
        "Не боясь за то в награду\n",
        "Получить пяток к наряду.\n",
        "Демобилизация! - 2х\n",
        "\n",
        "И поднимем мы бокалы\n",
        "Источник teksty-pesenok.ru\n",
        "В самых лучших ресторанах,\n",
        "Не боясь нотации.\n",
        "Не боясь за эту шутку\n",
        "Получить 15 суток.\n",
        "Демобилизация! - 2х\n",
        "Скорый поезд к дому мчится.\n",
        "Прилетел домой как птица,\n",
        "Прилетел как птица я!\n",
        "Снял погоны и петлицы,\n",
        "И уже успел напиться\n",
        "Демобилизация!\n",
        "'''\n",
        "\n",
        "song_8 = '''Сигарета мелькает во тьме\n",
        "Ветер пепел в лицо швырнул мне\n",
        "И обугленный фильтр\n",
        "На пальцах мне оставил ожог\n",
        "Скрипнув сталью открылася дверь\n",
        "Ты идёшь ты моя теперь\n",
        "Я приятную дрожь ощущаю с головы до ног\n",
        "\n",
        "Ты со мною забудь обо всём\n",
        "Эта ночь нам покажется сном\n",
        "Я возьму тебя и прижму как родную дочь\n",
        "Нас окутает дым сигарет\n",
        "Ты уйдёшь как настанет рассвет\n",
        "И следы на постели напомнят про счастливую ночь\n",
        "\n",
        "Эротичный лунный свет\n",
        "Запретит сказать тебе нет\n",
        "И опустится плавно на пол всё твоё б*льё\n",
        "Шум деревьев и ветер ночной\n",
        "Стон заглушат твой и мой\n",
        "И биение сердца пылающего адским огнём\n",
        "\n",
        "Ты со мною забудь обо всём\n",
        "Эта ночь нам покажется сном\n",
        "Я возьму тебя и прижму как родную дочь\n",
        "Нас окутает дым сигарет\n",
        "Ты уйдёшь как настанет рассвет\n",
        "И следы на постели напомнят про счастливую ночь\n",
        "\n",
        "Твои бёдра в сиянии Луны\n",
        "Так прекрасны и мне так нужны\n",
        "Кровь тяжёлым напором ударит прямо в сердце мне\n",
        "Груди плавно качнутся в ночи\n",
        "Слышишь как моё сердце стучит\n",
        "Два пылающих тела сольются в ночной тишине\n",
        "\n",
        "Ты со мною забудь обо всём\n",
        "Эта ночь нам покажется сном\n",
        "Я возьму тебя и прижму как родную дочь\n",
        "Нас окутает дым сигарет\n",
        "Ты уйдёшь как настанет рассвет\n",
        "И следы на постели напомнят про счастливую ночь\n",
        "И следы на постели напомнят про счастливую ночь'''\n",
        "\n",
        "song_9 = '''Я друзья решил женится правда вот те крест\n",
        "У меня к невесте рос всё больший интерес\n",
        "Анадысь привёл её к родителям своим\n",
        "Было сразу видно что она по нраву им\n",
        "И она меня припёрла к мамочке своей\n",
        "Та поставила пузырь на зятёк мой пей\n",
        "Напякла бляны со с маслом наварила щей\n",
        "И я понял что она клёвая ваще\n",
        "\n",
        "Тёща моя ласковая\n",
        "Теща моя заботливая\n",
        "Молодая озорная ты родная мать\n",
        "Чего больше детям пожелать\n",
        "\n",
        "Свадьба пролетела как фанера над Москвой\n",
        "Стала тёща как собака очень очень злой\n",
        "Я забыл вкус самогона позабыл бляны\n",
        "Тёща говорит они мне на хр*н не нужны\n",
        "\n",
        "К тёще я со всей душою мам налей 100 грамм\n",
        "А она мне дулю в харю ни фига не дам\n",
        "Я такую тёщу не желаю и врагам\n",
        "Похудел я за 2 дня на 20 килограмм\n",
        "\n",
        "Тёща моя злая свинья\n",
        "Тёща моя коростовая\n",
        "Харя злая вот такая хочется плевать\n",
        "На фига нужна вторая мать\n",
        "\n",
        "Я не выдержу возьму и ножик наточу\n",
        "Тёщу я свою в натуре скоро замочу\n",
        "Полечу поколочу по роже постучу\n",
        "В общем я вторую мать малость поучу\n",
        "\n",
        "Эту песню сочинял я ровно 10 лет\n",
        "Мне надеюсь все зятья передадут привет\n",
        "Тёща кровь сосёт из нас прямо как вампир\n",
        "Я надеюсь что мне хором подпоёт весь мир\n",
        "\n",
        "Тёща моя злая свинья\n",
        "Тёща моя коростовая\n",
        "Харя злая вот такая хочется плевать\n",
        "На фига нужна вторая мать\n",
        "'''\n",
        "\n",
        "song_10 = '''Мне на днях исполнилось 16 лет,\n",
        "Захотел я двухколёсный драндулет,\n",
        "Я к батяне подошёл, сказал: \"Купи,\n",
        "Ты на \"Яву\" мне кусочек накопи!\"\n",
        "\n",
        "Мой папаша был хронический алкаш,\n",
        "Но на счастье на него напала блаж,\n",
        "Он в квартире все бутылки пособрал,\n",
        "И на пару тысяч он посуды сдал,\n",
        "\n",
        "\"Яву\", \"Яву\", взял я на халяву!\n",
        "\"Яву\", \"Яву\", взял я на халяву!\n",
        "\n",
        "Я пинком заехал в заводной рычаг,\n",
        "Дай Бог, чтоб движок мой мощный не зачах,\n",
        "До отказа ручку газа накрутил ,\n",
        "Тьфу ты чёрт, рукой я бабку зацепил!\n",
        "\n",
        "Ну и пусть, была бы техника цела,\n",
        "Бабок много \"Ява\", у меня одна,\n",
        "Бабку люди обнаружат по утру,\n",
        "А я тачку нежно тряпочкой протру.\n",
        "\n",
        "\"Ява\", \"Ява\"!Бабка, ух, разява!\n",
        "\"Ява\", \"Ява\"!Бабка, ух, разява!\n",
        "\n",
        "Подвезти раз попросил меня дружок,\n",
        "Дал я гари так, что покраснел движок,\n",
        "Вроде тихо он сидел и не дрожал,\n",
        "А сзади всё сиденье, с*ка обдристал!\n",
        "\n",
        "Раз подругу посадил на мотоцикл,\n",
        "У неё от страха прекратился цикл,\n",
        "Источник teksty-pesenok.ru\n",
        "Платье ветром дуло обнажился срам,\n",
        "И затычки разлетелись по кустам.\n",
        "\n",
        "\"Ява\", \"Ява\", не дрожи ш*лава!\n",
        "\"Ява\", \"Ява\", не дрожи ш*лава!\n",
        "\n",
        "Как-то пьяный возвращался я домой,\n",
        "Гнал на всю катушку мотоцикл свой,\n",
        "Было весело, я громко песни пел,\n",
        "И на пень трухлявый спьяну налетел,\n",
        "В тривелюшки всё погнулось колесо,\n",
        "Метров пять я носом пропахал песок,\n",
        "Я к утру домой обломки принесу,\n",
        "Был я с \"Явой\", а теперь я отс*су.\n",
        "\n",
        "\"Ява\", \"Ява\", пососи раззява!\n",
        "\"Ява\", \"Ява\", пососи раззява!\n",
        "'''\n",
        "\n",
        "song_10 = '''Из-за леса выезжает\n",
        "Конная милиция.\n",
        "Становись-ка девки раком —\n",
        "Будет репетиция!\n",
        "\n",
        "Я приехала в колхоз\n",
        "Имени Мичурина.\n",
        "Так и знала отъе.ут\n",
        "Словно сердце чуяло!\n",
        "\n",
        "Мимо тёщиного дома\n",
        "Я без шуток не хожу.\n",
        "То им х*р в забор просуну,\n",
        "То им ж*пу покажу!\n",
        "\n",
        "Я на Севере была\n",
        "Золото копала.\n",
        "Если б не моя п*зда,\n",
        "С голоду пропала!\n",
        "\n",
        "О-па, о-па, зелёная ограда,\n",
        "Девки вые.ли п*па — так ему и надо!\n",
        "\n",
        "Hа мосту стоял прохожий\n",
        "Hа е.ёну мать похожий.\n",
        "Вдруг откуда ни возьмись\n",
        "Появился в рот е.ись!\n",
        "\n",
        "Полюбила парня я,\n",
        "Да оказался без х*я.\n",
        "Да на х*я ж мне без х*я,\n",
        "Когда с х.ем до х*я!\n",
        "\n",
        "Как у нас на мокушке\n",
        "Соловей е*ет кукушку.\n",
        "Только слышно на суку:\n",
        "\"Чирик, п*здык, х*як, ку-ку!\"\n",
        "\n",
        "Мы с милёнком у метра\n",
        "Целовались до утра.\n",
        "Целовались бы ещё,\n",
        "Да болит влагалищо!\n",
        "\n",
        "О-па, о-па, зелёная ограда,\n",
        "Девки вые.ли п*па — так ему и надо!\n",
        "\n",
        "А девки в озере купались,\n",
        "Х*й резиновый нашли.\n",
        "Целый день они е*ались,\n",
        "Даже в школу не пошли!\n",
        "\n",
        "Мой милёнок под забором\n",
        "Х*й берёзовый нашёл.\n",
        "Примеряли всем народом —\n",
        "Hикому не подошёл!\n",
        "\n",
        "А из-за леса из-за гор\n",
        "Показал мужик топор.\n",
        "Hо не просто показал:\n",
        "Его к х.ю привязал!\n",
        "\n",
        "Мы с милёнком целовались,\n",
        "Стоя у завалинки.\n",
        "А я стояла и с.ала\n",
        "Ему на белы валенки!\n",
        "\n",
        "О-па, о-па, срослась п*зда и ж*па!\n",
        "Этого не может быть — промежуток должен быть!\n",
        "\n",
        "А Маньке целочку порвали,\n",
        "Саньку в ж.пу вые.ли.\n",
        "Опосля в рояль наср*ли —\n",
        "Чудно время провели!\n",
        "\n",
        "Мы с милёночком е.лись\n",
        "В сорокоградусный мороз.\n",
        "Ж.па инеем покрылась,\n",
        "Х*й стоял, как Дед Мороз!\n",
        "Источник teksty-pesenok.ru\n",
        "\n",
        "Hа Вогрэсовском мосту\n",
        "Церковь обокрали.\n",
        "В ж*пу вые.ли п*па\n",
        "И в колокол наср*ли!\n",
        "\n",
        "Я сосала давеча\n",
        "У Сергея Савича.\n",
        "Он на вид холёненький,\n",
        "А на вкус солёненький!\n",
        "\n",
        "О-па, о-па, зелёная ограда,\n",
        "Девки вые.ли п*па — так ему и надо!\n",
        "\n",
        "Помидоры, помидоры,\n",
        "Помидоры, овощи.\n",
        "П*зда едет на кобыле,\n",
        "Х*й на скорой помощи!\n",
        "\n",
        "Полюбила х*йебина\n",
        "И повесила портрет.\n",
        "А на утро поглядела:\n",
        "Х*й висит, а бина нет!\n",
        "\n",
        "Мы с приятелем вдвоём\n",
        "Работали на дизеле.\n",
        "Он лопух, и я лопух:\n",
        "У нас теплушку сп*здили!\n",
        "\n",
        "Полюбила тракториста\n",
        "И, как водится, дала.\n",
        "Три недели с*ськи мыла\n",
        "И соляркою с.ала!\n",
        "\n",
        "О-па, о-па, зелёная ограда,\n",
        "Девки вые.ли п*па — так ему и надо!\n",
        "\n",
        "Мне подруга дорогая п*рдаёт по рации:\n",
        "\"Я без \"Комбинации\", как без менструации!\"\n",
        "'''\n",
        "\n",
        "song_11 = '''Все хорошо, все в деревне хорошо (хорошо)!\n",
        "Все хорошо, все в деревне хорошо (хорошо)!\n",
        "Все хорошо, все в деревне хорошо!\n",
        "В деревне все нормально! В деревне хорошо!\n",
        "\n",
        "Хорошо в деревне летом!\n",
        "Пристает г*вно к штиблетам,\n",
        "Если ты в поселке этом\n",
        "Пару дней живешь при этом!\n",
        "Хорошо, б*я, если ты приехал прошвырнуться,\n",
        "Отдохнуть и посмотреть, как там колхозники е.утся, да!\n",
        "Хорошо там покататься на мопеде\n",
        "Иль, худой конец, на старом верном в(е)лосипеде!\n",
        "Хорошо и даже замечательно,\n",
        "Если ты потом домой съе*ешься обязательно!\n",
        "Классно, если здоровый ты и сильный бугай:\n",
        "Искупался, полежал на травке и бухай!\n",
        "А ну леску кидай, может клюнет судак!\n",
        "А вот и он, судак, и если ты не м.дак\n",
        "Тащи его, е.лом не щелкай, пока он не ушел!\n",
        "Тащи его, парень! И все будет хорошо!\n",
        "Может клюнет сом большой или дэцельный карась!\n",
        "Доклевались, с*ки, падлы! Вот и леска порвалась!\n",
        "\n",
        "Все хорошо, все в деревне хорошо (хорошо)!\n",
        "Все хорошо, все в деревне хорошо (хорошо)!\n",
        "Все хорошо, все в деревне хорошо!\n",
        "В деревне все нормально! В деревне хорошо!\n",
        "\n",
        "Все хорошо, все в деревне хорошо (хорошо)!\n",
        "Все хорошо, все в деревне хорошо (хорошо)!\n",
        "Все хорошо, все в деревне хорошо!\n",
        "В деревне все нормально! В деревне хорошо!\n",
        "\n",
        "А в деревне наплевать на всю вонючую эстраду!\n",
        "Для вас лето — это отдых, для них лето — это страда!\n",
        "Зае*ались чуваки, готовя сено,\n",
        "Ведь корову прокормить зимою целая проблема!\n",
        "Хорошо в деревне, если ты и фермер, и новатор!\n",
        "Ты пашешь на земле своей, как робот-терминатор,\n",
        "А в колхозе в сентябре поспеет рожь и пшеница:\n",
        "Трудно вечером бухнуть, труднее утром похмелиться —\n",
        "Надо в срок убрать все это: комбайнер, глотая пыль,\n",
        "Пашет сутками, его потом шатает, как ковыль.\n",
        "Ну а дома плачут дети, позабыв про все на свете:\n",
        "Они жрать хотят всегда, ведь на то они и дети.\n",
        "И жена, в теплушке и в резиновых калошах,\n",
        "Намоталась за весь день — она зае*алась тоже.\n",
        "Очень трудно! А тут еще и свой огород!\n",
        "Короче, хорошо в деревне, в рот компот!!!\n",
        "'''\n",
        "\n",
        "song_12 = '''Мама я корову подоил на лугу я сено накосил\n",
        "Мама я дровишек нарубил борова в сарае накормил\n",
        "А теперь под вечер я устал\n",
        "Целый день я круто попахал\n",
        "кушать очень сильно я хочу\n",
        "Что любую гадость проглочу\n",
        "\n",
        "Возьми мясо и хрящи навари крутые щи\n",
        "Ты чугун прополощи и вари в чугуне щи\n",
        "Кидай больше овощей не могу я жить без щей\n",
        "Чтоб я толстый был ваще навари мне русских щей\n",
        "\n",
        "Знаешь мать с тобой мне хорошо\n",
        "Но решил жениться я ещё\n",
        "Ты мне мать невесту подыщи\n",
        "Чтоб она варить умела щи\n",
        "Я без щей и дня не проживу\n",
        "В жёны даже дуру я возьму\n",
        "Пусть она кривая и в прыщах\n",
        "Лишь бы разбиралась она в щах\n",
        "\n",
        "Возьми мясо и хрящи навари крутые щи\n",
        "Ты чугун прополощи и вари в чугуне щи\n",
        "Кидай больше овощей не могу я жить без щей\n",
        "Чтоб я толстый был ваще навари мне русских щей\n",
        "\n",
        "Мать иди сюда чего скажу в армию я мама ухожу\n",
        "Мне повестка только что пришла\n",
        "Ну вот опять ты плакать начала\n",
        "Хорошо служить я буду мать\n",
        "Буду все приказы выполнять\n",
        "Ну а если не дадут мне щей\n",
        "Убегу из армии ваще\n",
        "\n",
        "Возьми мясо и хрящи навари крутые щи\n",
        "Ты чугун прополощи и вари в чугуне щи\n",
        "Кидай больше овощей не могу я жить без щей\n",
        "Чтоб я толстый был ваще навари мне русских щей'''\n",
        "\n",
        "song_13 = '''На коленях перед алтарем,\n",
        "Я стою, грудь пылает огнем,\n",
        "Перевернутый крест Люцифера висит на стене.\n",
        "Ты ушла от меня на тот свет,\n",
        "Жаль, со мною тебя рядом нет,\n",
        "Ты пылаешь сейчас без меня в жарком адском огне.\n",
        "\n",
        "На костре! На костре сгорела в огне,\n",
        "На костре! Моя ведьма сгорела в огне.\n",
        "На костре! На костре, сожжена на костре.\n",
        "На костре! Моя ведьма сгорела в огне.\n",
        "Эти святоши в терновом венке\n",
        "На кресте будут скоро висеть.\n",
        "Будут висеть с перебитыми ребрами,\n",
        "Смерть - инквизиторам, смерть!\n",
        "\n",
        "Ты была королевой ночи,\n",
        "Но они наточили мечи,\n",
        "Ты была сожжена инквизиторами на костре.\n",
        "Знай, что будешь ты отомщена,\n",
        "Да поможет мне в том сатана,\n",
        "Все священники будут висеть на кровавом кресте.\n",
        "\n",
        "На костре! На костре сгорела в огне,\n",
        "На костре! Моя ведьма сгорела в огне.\n",
        "На костре! На костре, сожжена на костре.\n",
        "На костре! Моя ведьма сгорела в огне.\n",
        "Эти святоши в терновом венке\n",
        "На кресте будут скоро висеть.\n",
        "Все инквизиторы кровью рыгать будут,\n",
        "Смерть - инквизиторам, смерть!\n",
        "\n",
        "Каждый день без тебя - это ад,\n",
        "Но ты не возвратишься назад,\n",
        "Без тебя, дорогая, никак не могу я уснуть.\n",
        "Знай, что скоро к тебе я приду,\n",
        "Мы увидимся вскоре в аду,\n",
        "Острый жертвенный нож я воткну в свою грешную грудь.\n",
        "\n",
        "На костре! На костре сгорела в огне,\n",
        "На костре! Моя ведьма сгорела в огне.\n",
        "На костре! На костре, сожжена на костре.\n",
        "На костре! Моя ведьма сгорела в огне.\n",
        "Эти святоши в терновом венке\n",
        "На кресте будут скоро висеть.\n",
        "Будут висеть с перебитыми ребрами,\n",
        "Смерть - инквизиторам, смерть!\n",
        "'''\n",
        "\n",
        "song_14 = '''Над станицею туман - это курит атаман,\n",
        "А казак с казачкой хлещут самогон,\n",
        "На базу мат-перемат, есаул лежит в умат,\n",
        "И завален пузырями весь прогон.\n",
        "\n",
        "И пока спокоен враг, вся станица на ушах,\n",
        "Мы упьёмся самогона, всем смертям назло,\n",
        "Но если вражеский урод нападёт на наш народ,\n",
        "Атаман, веди вперёд! Шашки наголо!\n",
        "\n",
        "На дворе гармонь орёт и бухло рекой течёт,\n",
        "Не устанет никогда казак бухать,\n",
        "Литр, два, четыре, пять, мало наливай опять,\n",
        "Самогон давно устали бабки гнать.\n",
        "\n",
        "И пока спокоен враг, вся станица на ушах,\n",
        "Мы упьёмся самогона, всем смертям назло,\n",
        "Но если вражеский урод нападёт на наш народ,\n",
        "Атаман, веди вперёд! Шашки наголо!\n",
        "Источник teksty-pesenok.ru\n",
        "\n",
        "Но если вдруг придёт беда, если вражая орда,\n",
        "Пожелает вдруг сделать нам подляк,\n",
        "Пусть не рыпается враг, всех замочим только так,\n",
        "С шашкою на танк бросится казак.\n",
        "\n",
        "И пока спокоен враг, вся станица на ушах,\n",
        "Мы упьёмся самогона, всем смертям назло,\n",
        "Но если вражеский урод нападёт на наш народ,\n",
        "Атаман, веди вперёд! Шашки наголо!\n",
        "'''\n",
        "\n",
        "\n",
        "songs = [song_1, song_2, song_3, song_4, song_5, song_6, song_7, song_8, song_9, song_10, song_11, song_12, song_13, song_14]\n",
        "\n",
        "songs = list(map(lambda x: x.replace('\\n\\n', ' \\n'), songs))\n",
        "#print(songs[0])\n",
        "songs = list(map(lambda x: x.replace('\\n', ' endline\\n'), songs))\n",
        "#print(songs[0])\n",
        "dataset = pd.DataFrame(songs, columns=['text'])\n",
        "dataset"
      ],
      "metadata": {
        "id": "unzJsmM4Aoke"
      },
      "execution_count": 88,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "nWbMN_19jfRT"
      },
      "source": [
        "### Preprocessing"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 90,
      "metadata": {
        "id": "LRmPPJegovBe",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "2ed80288-5d94-433d-8425-1fe94a51dc42"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "3000\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:12: FutureWarning: The default value of regex will change from True to False in a future version.\n",
            "  if sys.path[0] == '':\n"
          ]
        }
      ],
      "source": [
        "def tokenize_corpus(corpus, num_words=-1):\n",
        "  # Fit a Tokenizer on the corpus\n",
        "  if num_words > -1:\n",
        "    tokenizer = Tokenizer(num_words=num_words)\n",
        "  else:\n",
        "    tokenizer = Tokenizer()\n",
        "  tokenizer.fit_on_texts(corpus)\n",
        "  return tokenizer\n",
        "\n",
        "def create_lyrics_corpus(dataset, field):\n",
        "  # Remove all other punctuation\n",
        "  dataset[field] = dataset[field].str.replace('[{}]'.format(string.punctuation), '')\n",
        "  # Make it lowercase\n",
        "  dataset[field] = dataset[field].str.lower()\n",
        "  # Make it one long string to split by line\n",
        "  lyrics = dataset[field].str.cat()\n",
        "  corpus = lyrics.split('\\n')\n",
        "  # Remove any trailing whitespace\n",
        "  for l in range(len(corpus)):\n",
        "    corpus[l] = corpus[l].rstrip()\n",
        "  # Remove any empty lines\n",
        "  corpus = [l for l in corpus if l != '']\n",
        "\n",
        "  return corpus\n",
        "\n",
        "def tokenize_corpus(corpus, num_words=-1):\n",
        "  # Fit a Tokenizer on the corpus\n",
        "  if num_words > -1:\n",
        "    tokenizer = Tokenizer(num_words=num_words)\n",
        "  else:\n",
        "    tokenizer = Tokenizer()\n",
        "  tokenizer.fit_on_texts(corpus)\n",
        "  return tokenizer\n",
        "\n",
        "# Read the dataset from csv - this time with 250 songs\n",
        "#dataset = pd.read_csv('/tmp/songdata.csv', dtype=str)[:250]\n",
        "# Create the corpus using the 'text' column containing lyrics\n",
        "corpus = create_lyrics_corpus(dataset, 'text')\n",
        "# Tokenize the corpus\n",
        "tokenizer = tokenize_corpus(corpus, num_words=3000)\n",
        "total_words = tokenizer.num_words\n",
        "\n",
        "# There should be a lot more words now\n",
        "print(total_words)\n",
        "\n",
        "sequences = []\n",
        "for line in corpus:\n",
        "\ttoken_list = tokenizer.texts_to_sequences([line])[0]\n",
        "\tfor i in range(1, len(token_list)):\n",
        "\t\tn_gram_sequence = token_list[:i+1]\n",
        "\t\tsequences.append(n_gram_sequence)\n",
        "\n",
        "# Pad sequences for equal input length \n",
        "max_sequence_len = max([len(seq) for seq in sequences])\n",
        "sequences = np.array(pad_sequences(sequences, maxlen=max_sequence_len, padding='pre'))\n",
        "\n",
        "# Split sequences between the \"input\" sequence and \"output\" predicted word\n",
        "input_sequences, labels = sequences[:,:-1], sequences[:,-1]\n",
        "# One-hot encode the labels\n",
        "one_hot_labels = tf.keras.utils.to_categorical(labels, num_classes=total_words)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "cECbqT-blMk-"
      },
      "source": [
        "### Train a (Better) Text Generation Model\n",
        "\n",
        "With more data, we'll cut off after 100 epochs to avoid keeping you here all day. You'll also want to change your runtime type to GPU if you haven't already (you'll need to re-run the above cells if you change runtimes)."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 91,
      "metadata": {
        "id": "7nHOp6uWlP_P",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "13c9a476-7a5b-41b8-ae5b-ebc486a9d9cb"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Epoch 1/200\n",
            "96/96 [==============================] - 10s 13ms/step - loss: 6.8162 - accuracy: 0.1813\n",
            "Epoch 2/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 5.8061 - accuracy: 0.1839\n",
            "Epoch 3/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 5.7153 - accuracy: 0.1839\n",
            "Epoch 4/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 5.6910 - accuracy: 0.1839\n",
            "Epoch 5/200\n",
            "96/96 [==============================] - 1s 15ms/step - loss: 5.5818 - accuracy: 0.1839\n",
            "Epoch 6/200\n",
            "96/96 [==============================] - 2s 17ms/step - loss: 5.3434 - accuracy: 0.1839\n",
            "Epoch 7/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 5.2305 - accuracy: 0.1842\n",
            "Epoch 8/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 5.1530 - accuracy: 0.1878\n",
            "Epoch 9/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 5.0711 - accuracy: 0.1898\n",
            "Epoch 10/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 4.9961 - accuracy: 0.1911\n",
            "Epoch 11/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 4.9506 - accuracy: 0.1904\n",
            "Epoch 12/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 4.8690 - accuracy: 0.1940\n",
            "Epoch 13/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 4.8437 - accuracy: 0.1950\n",
            "Epoch 14/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 4.7632 - accuracy: 0.1992\n",
            "Epoch 15/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 4.6832 - accuracy: 0.2028\n",
            "Epoch 16/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 4.6259 - accuracy: 0.2106\n",
            "Epoch 17/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 4.5668 - accuracy: 0.2132\n",
            "Epoch 18/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 4.5081 - accuracy: 0.2260\n",
            "Epoch 19/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 4.4648 - accuracy: 0.2233\n",
            "Epoch 20/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 4.4330 - accuracy: 0.2250\n",
            "Epoch 21/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 4.3754 - accuracy: 0.2286\n",
            "Epoch 22/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 4.3575 - accuracy: 0.2308\n",
            "Epoch 23/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 4.2998 - accuracy: 0.2315\n",
            "Epoch 24/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 4.2561 - accuracy: 0.2312\n",
            "Epoch 25/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 4.2374 - accuracy: 0.2312\n",
            "Epoch 26/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 4.2571 - accuracy: 0.2315\n",
            "Epoch 27/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 4.2402 - accuracy: 0.2315\n",
            "Epoch 28/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 4.1618 - accuracy: 0.2361\n",
            "Epoch 29/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 4.1166 - accuracy: 0.2348\n",
            "Epoch 30/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 4.0775 - accuracy: 0.2439\n",
            "Epoch 31/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 4.0774 - accuracy: 0.2419\n",
            "Epoch 32/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 4.0309 - accuracy: 0.2406\n",
            "Epoch 33/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 3.9808 - accuracy: 0.2452\n",
            "Epoch 34/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 3.9247 - accuracy: 0.2478\n",
            "Epoch 35/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 3.8740 - accuracy: 0.2533\n",
            "Epoch 36/200\n",
            "96/96 [==============================] - 2s 17ms/step - loss: 3.8265 - accuracy: 0.2579\n",
            "Epoch 37/200\n",
            "96/96 [==============================] - 1s 15ms/step - loss: 3.8033 - accuracy: 0.2560\n",
            "Epoch 38/200\n",
            "96/96 [==============================] - 2s 16ms/step - loss: 3.7765 - accuracy: 0.2550\n",
            "Epoch 39/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 3.7243 - accuracy: 0.2648\n",
            "Epoch 40/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 3.7308 - accuracy: 0.2657\n",
            "Epoch 41/200\n",
            "96/96 [==============================] - 2s 18ms/step - loss: 3.6969 - accuracy: 0.2602\n",
            "Epoch 42/200\n",
            "96/96 [==============================] - 2s 17ms/step - loss: 3.6202 - accuracy: 0.2680\n",
            "Epoch 43/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 3.5922 - accuracy: 0.2693\n",
            "Epoch 44/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 3.5693 - accuracy: 0.2775\n",
            "Epoch 45/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 3.5156 - accuracy: 0.2817\n",
            "Epoch 46/200\n",
            "96/96 [==============================] - 2s 16ms/step - loss: 3.4811 - accuracy: 0.2801\n",
            "Epoch 47/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 3.4531 - accuracy: 0.2892\n",
            "Epoch 48/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 3.4315 - accuracy: 0.2889\n",
            "Epoch 49/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 3.4065 - accuracy: 0.2908\n",
            "Epoch 50/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 3.4049 - accuracy: 0.2876\n",
            "Epoch 51/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 3.4024 - accuracy: 0.2866\n",
            "Epoch 52/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 3.3547 - accuracy: 0.2980\n",
            "Epoch 53/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 3.3042 - accuracy: 0.3022\n",
            "Epoch 54/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 3.2556 - accuracy: 0.3081\n",
            "Epoch 55/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 3.2262 - accuracy: 0.3107\n",
            "Epoch 56/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 3.1778 - accuracy: 0.3146\n",
            "Epoch 57/200\n",
            "96/96 [==============================] - 2s 16ms/step - loss: 3.1593 - accuracy: 0.3208\n",
            "Epoch 58/200\n",
            "96/96 [==============================] - 2s 17ms/step - loss: 3.1427 - accuracy: 0.3231\n",
            "Epoch 59/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 3.1186 - accuracy: 0.3270\n",
            "Epoch 60/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 3.0883 - accuracy: 0.3251\n",
            "Epoch 61/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 3.0619 - accuracy: 0.3329\n",
            "Epoch 62/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 3.0626 - accuracy: 0.3358\n",
            "Epoch 63/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 3.1668 - accuracy: 0.3202\n",
            "Epoch 64/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 3.1303 - accuracy: 0.3186\n",
            "Epoch 65/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.9854 - accuracy: 0.3414\n",
            "Epoch 66/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.9441 - accuracy: 0.3446\n",
            "Epoch 67/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.9041 - accuracy: 0.3557\n",
            "Epoch 68/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.8655 - accuracy: 0.3554\n",
            "Epoch 69/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.8257 - accuracy: 0.3616\n",
            "Epoch 70/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.8028 - accuracy: 0.3701\n",
            "Epoch 71/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.7721 - accuracy: 0.3707\n",
            "Epoch 72/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.7406 - accuracy: 0.3635\n",
            "Epoch 73/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.7192 - accuracy: 0.3776\n",
            "Epoch 74/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.7304 - accuracy: 0.3717\n",
            "Epoch 75/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.6999 - accuracy: 0.3655\n",
            "Epoch 76/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.6624 - accuracy: 0.3802\n",
            "Epoch 77/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.6269 - accuracy: 0.3896\n",
            "Epoch 78/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.6089 - accuracy: 0.3838\n",
            "Epoch 79/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.5726 - accuracy: 0.3926\n",
            "Epoch 80/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.6730 - accuracy: 0.3763\n",
            "Epoch 81/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.5523 - accuracy: 0.3919\n",
            "Epoch 82/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.5606 - accuracy: 0.3939\n",
            "Epoch 83/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.5149 - accuracy: 0.4007\n",
            "Epoch 84/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.4339 - accuracy: 0.4297\n",
            "Epoch 85/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.4696 - accuracy: 0.4072\n",
            "Epoch 86/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.4027 - accuracy: 0.4314\n",
            "Epoch 87/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.3526 - accuracy: 0.4353\n",
            "Epoch 88/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.3249 - accuracy: 0.4402\n",
            "Epoch 89/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.3054 - accuracy: 0.4457\n",
            "Epoch 90/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.2644 - accuracy: 0.4568\n",
            "Epoch 91/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.2751 - accuracy: 0.4526\n",
            "Epoch 92/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.2867 - accuracy: 0.4467\n",
            "Epoch 93/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.2402 - accuracy: 0.4539\n",
            "Epoch 94/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.2109 - accuracy: 0.4623\n",
            "Epoch 95/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.1876 - accuracy: 0.4646\n",
            "Epoch 96/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.1676 - accuracy: 0.4672\n",
            "Epoch 97/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.1593 - accuracy: 0.4757\n",
            "Epoch 98/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.1391 - accuracy: 0.4757\n",
            "Epoch 99/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.0934 - accuracy: 0.4835\n",
            "Epoch 100/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.0920 - accuracy: 0.4826\n",
            "Epoch 101/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.0454 - accuracy: 0.4943\n",
            "Epoch 102/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.0663 - accuracy: 0.4904\n",
            "Epoch 103/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.0680 - accuracy: 0.4799\n",
            "Epoch 104/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.0215 - accuracy: 0.4998\n",
            "Epoch 105/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.0269 - accuracy: 0.5073\n",
            "Epoch 106/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 2.2038 - accuracy: 0.4571\n",
            "Epoch 107/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.0898 - accuracy: 0.4734\n",
            "Epoch 108/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 2.0056 - accuracy: 0.5015\n",
            "Epoch 109/200\n",
            "96/96 [==============================] - 2s 16ms/step - loss: 1.9673 - accuracy: 0.5145\n",
            "Epoch 110/200\n",
            "96/96 [==============================] - 2s 17ms/step - loss: 1.9403 - accuracy: 0.5161\n",
            "Epoch 111/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.9694 - accuracy: 0.5057\n",
            "Epoch 112/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.8800 - accuracy: 0.5236\n",
            "Epoch 113/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.8596 - accuracy: 0.5354\n",
            "Epoch 114/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.8006 - accuracy: 0.5527\n",
            "Epoch 115/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.8289 - accuracy: 0.5465\n",
            "Epoch 116/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.8489 - accuracy: 0.5422\n",
            "Epoch 117/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.8395 - accuracy: 0.5357\n",
            "Epoch 118/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.8117 - accuracy: 0.5484\n",
            "Epoch 119/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.8467 - accuracy: 0.5393\n",
            "Epoch 120/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.7541 - accuracy: 0.5602\n",
            "Epoch 121/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.7528 - accuracy: 0.5673\n",
            "Epoch 122/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.7527 - accuracy: 0.5634\n",
            "Epoch 123/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.7220 - accuracy: 0.5722\n",
            "Epoch 124/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.6968 - accuracy: 0.5748\n",
            "Epoch 125/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.6649 - accuracy: 0.5853\n",
            "Epoch 126/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.6561 - accuracy: 0.5836\n",
            "Epoch 127/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.6826 - accuracy: 0.5725\n",
            "Epoch 128/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.7101 - accuracy: 0.5660\n",
            "Epoch 129/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.7143 - accuracy: 0.5742\n",
            "Epoch 130/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.6600 - accuracy: 0.5853\n",
            "Epoch 131/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.6122 - accuracy: 0.5957\n",
            "Epoch 132/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.5900 - accuracy: 0.5960\n",
            "Epoch 133/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.5809 - accuracy: 0.6081\n",
            "Epoch 134/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.6190 - accuracy: 0.5836\n",
            "Epoch 135/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.6061 - accuracy: 0.5977\n",
            "Epoch 136/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.6212 - accuracy: 0.5866\n",
            "Epoch 137/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.6118 - accuracy: 0.5977\n",
            "Epoch 138/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.5355 - accuracy: 0.6104\n",
            "Epoch 139/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.5213 - accuracy: 0.6140\n",
            "Epoch 140/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.4829 - accuracy: 0.6218\n",
            "Epoch 141/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.4772 - accuracy: 0.6221\n",
            "Epoch 142/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.4617 - accuracy: 0.6276\n",
            "Epoch 143/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.4897 - accuracy: 0.6224\n",
            "Epoch 144/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.4428 - accuracy: 0.6397\n",
            "Epoch 145/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.4150 - accuracy: 0.6469\n",
            "Epoch 146/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.4311 - accuracy: 0.6329\n",
            "Epoch 147/200\n",
            "96/96 [==============================] - 2s 18ms/step - loss: 1.4222 - accuracy: 0.6453\n",
            "Epoch 148/200\n",
            "96/96 [==============================] - 2s 16ms/step - loss: 1.4044 - accuracy: 0.6407\n",
            "Epoch 149/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.3637 - accuracy: 0.6658\n",
            "Epoch 150/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.3552 - accuracy: 0.6586\n",
            "Epoch 151/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.4180 - accuracy: 0.6420\n",
            "Epoch 152/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.3896 - accuracy: 0.6417\n",
            "Epoch 153/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.3899 - accuracy: 0.6469\n",
            "Epoch 154/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.3678 - accuracy: 0.6475\n",
            "Epoch 155/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.3186 - accuracy: 0.6775\n",
            "Epoch 156/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.3174 - accuracy: 0.6674\n",
            "Epoch 157/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.3234 - accuracy: 0.6642\n",
            "Epoch 158/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.5367 - accuracy: 0.6120\n",
            "Epoch 159/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.4432 - accuracy: 0.6293\n",
            "Epoch 160/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.3336 - accuracy: 0.6645\n",
            "Epoch 161/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.3266 - accuracy: 0.6635\n",
            "Epoch 162/200\n",
            "96/96 [==============================] - 2s 19ms/step - loss: 1.3136 - accuracy: 0.6609\n",
            "Epoch 163/200\n",
            "96/96 [==============================] - 1s 15ms/step - loss: 1.2744 - accuracy: 0.6772\n",
            "Epoch 164/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.2694 - accuracy: 0.6700\n",
            "Epoch 165/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.2421 - accuracy: 0.6841\n",
            "Epoch 166/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.2220 - accuracy: 0.6860\n",
            "Epoch 167/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.2026 - accuracy: 0.6971\n",
            "Epoch 168/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.1924 - accuracy: 0.7043\n",
            "Epoch 169/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.1773 - accuracy: 0.7020\n",
            "Epoch 170/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.1742 - accuracy: 0.7033\n",
            "Epoch 171/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.1612 - accuracy: 0.7134\n",
            "Epoch 172/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.1575 - accuracy: 0.7023\n",
            "Epoch 173/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.1834 - accuracy: 0.7026\n",
            "Epoch 174/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.1625 - accuracy: 0.7082\n",
            "Epoch 175/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.1663 - accuracy: 0.7030\n",
            "Epoch 176/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.1769 - accuracy: 0.6984\n",
            "Epoch 177/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.1425 - accuracy: 0.7085\n",
            "Epoch 178/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.1153 - accuracy: 0.7157\n",
            "Epoch 179/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.1104 - accuracy: 0.7154\n",
            "Epoch 180/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.0936 - accuracy: 0.7238\n",
            "Epoch 181/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.0783 - accuracy: 0.7277\n",
            "Epoch 182/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.0520 - accuracy: 0.7349\n",
            "Epoch 183/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.1187 - accuracy: 0.7127\n",
            "Epoch 184/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.1528 - accuracy: 0.6922\n",
            "Epoch 185/200\n",
            "96/96 [==============================] - 1s 13ms/step - loss: 1.2470 - accuracy: 0.6707\n",
            "Epoch 186/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.1727 - accuracy: 0.6929\n",
            "Epoch 187/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.1392 - accuracy: 0.7020\n",
            "Epoch 188/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.1092 - accuracy: 0.7111\n",
            "Epoch 189/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.0506 - accuracy: 0.7297\n",
            "Epoch 190/200\n",
            "96/96 [==============================] - 1s 15ms/step - loss: 1.0324 - accuracy: 0.7317\n",
            "Epoch 191/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.0108 - accuracy: 0.7444\n",
            "Epoch 192/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.0153 - accuracy: 0.7388\n",
            "Epoch 193/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 1.0208 - accuracy: 0.7372\n",
            "Epoch 194/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 0.9665 - accuracy: 0.7515\n",
            "Epoch 195/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 0.9628 - accuracy: 0.7529\n",
            "Epoch 196/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 0.9479 - accuracy: 0.7532\n",
            "Epoch 197/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 0.9707 - accuracy: 0.7454\n",
            "Epoch 198/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 0.9532 - accuracy: 0.7489\n",
            "Epoch 199/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 0.9924 - accuracy: 0.7352\n",
            "Epoch 200/200\n",
            "96/96 [==============================] - 1s 14ms/step - loss: 0.9701 - accuracy: 0.7473\n"
          ]
        }
      ],
      "source": [
        "from tensorflow.keras.models import Sequential\n",
        "from tensorflow.keras.layers import Embedding, LSTM, Dense, Bidirectional\n",
        "\n",
        "model = Sequential()\n",
        "model.add(Embedding(total_words, 64, input_length=max_sequence_len-1))\n",
        "model.add(Bidirectional(LSTM(64, return_sequences=True)))\n",
        "model.add(Bidirectional(LSTM(32, return_sequences=True)))\n",
        "model.add(Bidirectional(LSTM(32)))\n",
        "model.add(Dense(total_words, activation='softmax'))\n",
        "model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])\n",
        "history = model.fit(input_sequences, one_hot_labels, epochs=200, verbose=1)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "MgvIz20nlQcq"
      },
      "source": [
        "### View the Training Graph"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 92,
      "metadata": {
        "id": "rOqmmarvlSLh",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 279
        },
        "outputId": "78a4ef1c-e460-4030-ca83-5dc646b45ae5"
      },
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<Figure size 432x288 with 1 Axes>"
            ],
            "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYIAAAEGCAYAAABo25JHAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO3deXiU1dn48e+dyR6SAEkIS0gI+45ABDdcqlbcwH2vWttqF6utra3a91V/dq+vttWiLW2trbu2ttK6oALigixhXwMhAbIQspF9m8zcvz9mSAMkkEBmSeb+XFeuzHPmzMydZybPPeec5zlHVBVjjDGhKyzQARhjjAksSwTGGBPiLBEYY0yIs0RgjDEhzhKBMcaEuPBAB9BdycnJOmLEiECHYYwxvcratWvLVTWlo/t6XSIYMWIE2dnZgQ7DGGN6FRHZ29l91jVkjDEhzhKBMcaEOEsExhgT4iwRGGNMiLNEYIwxIc4SgTHGhDhLBMYYE+J63XUExhjT1zQ5XazKr2R3aR3NrW5uPT2DuCj/HZ4tERhjTADlltZx9bMrqG50tpUdbGjhoUsmoKqIiM9jsK4hY4wJoDfXFVLX3Mqfb8ti/f9eyLUz0/jLZ/ksWJbL9B9/wIrcclSVxxfvYEdJjU9isERgjDF+tG7fQfLL69u2P9h2gFkjBnL+hFQGxEVy/0XjiHCE8fjiHKoanLyeXcC6fQdZsGw3W4p8kwisa8gYY/ykyeni1j+vJjoijEV3n0VLq5tdpXXcOCu9rc6ghGh+dc1U9pTXk1dWzwfbDhDuCCMmwsHcyYN9EpclAmOM8ZOlO0qpa26l0Snc9cJapqf3B+DCiamH1bts6lBv/QO8ub6Iv68t5Mrpw+jnowFk6xoyxpgT0OR0UdXQ0q3HLNpQTEp8FM/cPIOdB2r52+d7GT84nuEDYzusf+boZOK9B/+rZgw76Zg7Yy0CY4zpJlXlrhfWUniwgSXfO7dLj6lpcrI0p5SbZqVz0aTBrH7oAhZvK2Fcanynj4kKd3DxlMF8nlfBGaOSeyj6o1kiMMaYbvrPpv0s31kGQHldM8n9oo5Z//PdFTy+eActrW7mneLp9kmMjeC6rOHHfa3H5k+mudWNI8x3p5Fa15AxxnRDcVUjj/1nGwNiIwDYVFh1zPpOl5uv/nUNJdVN/OSKyUwf3r9brxcd4SAxJuKE4+0KSwTGGNNFOSW1XPXMChpbXCy8NYswgY0F1cd8zJaiaupbXPzo0oncclqGXy4Q6y7rGjLGmC5wuZW7X16HW5U3vn46E4YkMHpQv+O2CNbsqQTg1MwB/gjzhFiLwBhjuuCtDUXsKq3jkcsnMWFIAgBT0/qzqbAaVe30cavzDzIiKZZB8dH+CrXbLBEYY8wxLN9ZxhPv5/DE+zuZNDSBi9td1DUtLZGK+haKqho7fKzbrWTvreTUEQP9Fe4JsURgjAk5GwqquP+NjThd7mPWK65q5BsvruXppbkUVzfyw7njCWt39s7UNM/A76bCjscJdpfVUdXg5NTM4E4ENkZgjAk5v3pvByt2V3DBxFQumtT5tA2P/XsbblU+vv88BiVEER3hOOz+8UPiiXAIGwuruGTKkKMe/2luOQCzQrlFICJzRSRHRHJF5IEO7v+1iGzw/uwUkWOPuhhjzEnavr+GFbsrAHhl9T7Ac5Xwl/68ikcXbW3r71+xu5z3tpZwz/ljSE+KPSoJgOeCrwlDEtjUwZlDrS43z32Wz7S0RDKSOr5yOFj4LBGIiANYAFwMTARuFJGJ7euo6ndV9RRVPQV4GnjTV/EYY0KT2608+9Fulu44gMut/PHjPGIiHNx6egbLd5ZRUNnAQ29u5pNd5Ty/Yg/PLt8NwJ8/ySe5XyR3nJl5zOefmpbIlqJq3O7DB4wXbSymoLKRb39hTFCeMtqeL7uGZgG5qpoHICKvAvOBbZ3UvxF4xIfxGGNC0BtrC/jlezsAiI100NDi4rbTM/ja2SN5YeVezn58GarwnQvGkFdWz6/ey6GpxcWSHaXce/6YDlsC7U1L68+LK/eRV17P6EH9AM+ppguW5TJhSALnTxjk87/xZPkyEQwDCtptFwKzO6ooIhlAJrDUh/EYY0JMRV0zP393B7NGDOSK6cPYVFjF6aOSuHjyECLDw/jFVVPYU9FAZnIc18xIo8Xl5mBDC08tzSXSEcbNp6Uf9zWmea8U3lhQ1ZYI3ttSwu6yehbcNCPoWwMQPIPFNwB/V1VXR3eKyJ3AnQDp6cd/Y4wxBuDppbnUNbXy0ysnMyY1nptmH378uP7Uw7ejwxws/FIW33tjA6NS+nXp3P9RKf2IjXSwqbCKq2em4XYrTy/dxaiUOJ+tH9DTfJkIioD2Myqlecs6cgPwrc6eSFUXAgsBsrKyOr9ywxhjvBpbXPxjXSGXTR3CmGPM8HmkmEgHz9w8s8v1HWHC5GGJbPSeQrp0Ryk7Smp58rppPp0orif58qyhNcAYEckUkUg8B/tFR1YSkfHAAOBzH8ZijAkx/9lUTG1T62Grf/nKtLREtu2vwely8+H2AyTGRDBv2lCfv25P8VkiUNVW4G5gMbAdeF1Vt4rIYyIyr13VG4BX9VjXaBtjTDe43crLq/cxMiWOWX64mGtqWn9aWt3klNSyuaiaqWmJhDt6z/W6Ph0jUNV3gHeOKHv4iO1HfRmDMSa0rMqr4ME3N5NXXs8jl0/0y2Dt1LREALL3VLLzQC1fnTPS56/Zk4JlsNgYY3rEz9/dQaPTxW9vOIXLp/qneyZ9YCz9YyN4Y20hTpcyZViiX163p/SetosxJmRsK66hsr7r6wFXNzopq23mQE0TGwqquHl2OvNPGXbYvEC+JCJMGZbI1uIaAEsExhhzMlSVm/60kvvf2Njlx3zv9Y1c/vSn/HO958TEY80f5CuHuocSYyJIGxDj99c/GZYIjDFBpayumaoGJ0t2lJJfXn/c+s2tLj7NLaOkponHF+eQmRzXdmGXPx2aiXTKsMRecRFZe5YIjDFBZU95Q9vt5z/LP279tXsP0uR0Mza1Hy638sVJqQE5EE87lAjSele3EFgiMMb42dbi6mOuA5BfXgd4pm5+Y20h2d6lHjvzya5ywsOE5788i6tnpHHzrIwejberBidG87ubph93krpgZInAGOM3+6sbuezpT/np29s7rZNXXk+kI4xfXjOVpH6RXL9wJf/eWNx2f1FVI1cs+Ix7XlnPO5v388muMmakD2Bo/xieuG4a6QGc8vmyqUNJiY8K2OufKEsExhi/2VZcgyr87fM9bO5kVa/8snoykmLJTI7j7XvmMDgh+rBEsCa/kg0FVXyyq4xvvrSOLUU1nDUm2U9/Qd9kicAY4zc7SmoBGBAbycOLtnRYJ7+8nhHJcQAkREeQkRR72KmkhQc9Ywif/vAL/OzKKUwb3r9XTecQjCwRGGP8JqeklmH9Y/j6OaNYv6/qqEXfXW5lb2UDI72JACCpXxQVhyWCRpL7RREXFc5Ns9N561tntiUOc2IsERhj/GZHSQ3jBsczZ6ynK+cz75q+hxRXNdLS6iazfSKIi6S8rrltu/BgY687Tz/YWSIwxvhFS6ubvLJ6xg+OZ1xqPMn9Io9KBIeuGzgyEdQ2tdLc6lmupOBggyWCHmaJwBjT4w7UNPHNl9ayv9rT9VNR18zusjpa3cq4wfGICGeOTuaz3HJUlSani/te28B9r28AIDPl8K4hgIP1TlxupbiqkeEDg3sx+N7GJp0zxvS4x/69jXc2lzBhcAIXTkrlsqc+bfuWP35wAgBnjk7mrQ3FbC2uYeHHeSzaWMy8aUOZlTnwsJXBBsZFAlBe14yiOF1qLYIeZonAGNOjluWU8vbm/UQ4hMXbSqhtbqXVrewqrSPCIYz0fts/a7RnnOCypz8F4Adzx/HNc0cf9XzJ/TyJoKK+hUanp3sobYC1CHqSJQJjTI96eskuMpPjuGr6MJ74YCcFlY1cMCGVCUPiKa1pJsK7YMvQ/jH84Usz2VlSS2pCNNdmpXX4fIe6hirqmqn0zhxhLYKeZYnAGNNjapucbCys5pvnjuKyaUN54oOdVDc6uWL6UC7rYG2AiyYNPu5MoUneFkFlfQuNLZ4WwbD+lgh6kg0WG2N6zJo9lbjcyukjk8hMjmNsaj/6RYVzwYTUE37O+KhwIhxCeV0LBQcbGBQfRXSEowejNtYiMMactJZWN44w4fPdFUSGhzEjYwAAP54/mapG50kduEWEpLgoKuqaKaqyawh8wRKBMeakVDc6uebZFSTERFDb5GRGev+2A//skUk98hpJ/SIpq2tma3ENcwOw6ExfZ4nAGHNCWlrdFFc18th/tpFfXo9LFVW478KxPf5aA+MiWZNfSX2Li9NH9UxyMf9licAY023NrS7m/+6ztknkfjx/Eo1OFz97ZwfnjE3p8ddL7hdFvXeg2BJBz7NEYIzptr+t2MuOklp+MHccs0YMZGbGAESEK6YPO+xisJ6S5L2obGRKHKkJPf/8oc4SgTGmW8rrmnlq6S7OHZdy1AVgvkgC8N9rCc6w1oBP2Omjxpguyy2t47rff06T08WPLpngt9c91CI4Y5QtQOMLlgiMMW0O1rewfX9Nh/c5XW5u+dMqqhudvPTV0xiTGu+3uE4flcQlUwYzx1Yi8wmfJgIRmSsiOSKSKyIPdFLnOhHZJiJbReRlX8ZjjDm2hxdt5brff47LrUfd91luOSU1Tfz0yinMyhzo17iGD4zlmZtnEh8d4dfXDRU+GyMQEQewALgQKATWiMgiVd3Wrs4Y4EHgTFU9KCKDfBWPMebYqhudLN5aQkurm32VDYetCQCwaGMx8dHhnDe+588KMoHlyxbBLCBXVfNUtQV4FZh/RJ2vAQtU9SCAqpb6MB5jzDG8u3k/La1uAHYc0T3U5HTx/tYDzJ00mKhwm96hr/FlIhgGFLTbLvSWtTcWGCsin4nIShGZ29ETicidIpItItllZWU+CteY0KSqlFQ38cbaQjKSYgkT2L6/hlV5FTzy1hZUlWU7SqlrbmXeKbZIfF8U6NNHw4ExwLlAGvCxiExR1ar2lVR1IbAQICsr6+jOS2PMCfvft7bw4sp9gGdNgH+sLWR7SS2bi6pZllPGxVOG8Fp2AakJUZzeQ1NGmODiy0RQBAxvt53mLWuvEFilqk4gX0R24kkMa3wYlzHGq6qhhTeyCzl//CCuzRrOueNS2FZcw6r8SqobnAD8+oOdrN5TybfPG024w0407It8+a6uAcaISKaIRAI3AIuOqPMvPK0BRCQZT1dRng9jMsa08/e1hTS3uvneF8cxd/JgoiMcTBiSQFltMy0uN9PSElmVXwnAdacOP86zmd7KZ4lAVVuBu4HFwHbgdVXdKiKPicg8b7XFQIWIbAOWAferaoWvYjIm1KzdW8n73jOBjqSqvLxqHzPS+zNxaEJb+fjBnusDkuIi+flVUwE4Z2yKLQ/Zh/l0jEBV3wHeOaLs4Xa3FbjP+2OM6UFNThdf+Ws2VQ1OUuKjePMbZzB84H8P5it2V5BXXs+vr5922OPGD/EkhQsnpjJxaAI/uWIys/183YDxL+vwM6aPemtDEVUNTu6/aBwH61t4YeXew+5/4fO9DIiN4OLJQw4rH5oYzcOXTWybR+iW0zL8ehWx8T9LBMb0QarK8yv2Mn5wPN88dxQXTEj1jgd4pnIuqW7ig+0HuC5r+FGrh4kId5yVSXqSdQWFCksExvQxTpebZz7azfb9Ndx6+ghEhJtmp1NZ38L7Ww8A8MrqfbhVuWl2eoCjNcEg0NcRGGN6kKpyy59WsSq/kvPHD+KqGZ5rOM8anczwgTH88ZM8zhiVxF8+y+f88YPISIo7zjOaUGAtAmP6gKKqRuqbW3l/2wFW5Vfy8GUT+fPtp7Z1+4SFCfdfNJ5NhdVc/ewKaptb+f5F4wIctQkW1iIwppcrqmrki08uZ1BCNOFhQmZyHLeennFUvcunDuG9Lft5Z3MJ18xMY/zghA6ezYQiSwTG9HL/b9FWXKocbGihqsHJk9dN6/AKYBHhJ1dMIW1ALF+dkxmASE2wskRgTC+2fGcZ7287wA/njueiSaks3VHKvGmdTww3MC6Sh/y4spjpHSwRGNOLfbjtAP2iwvnKWZlEhocxMqVfoEMyvZANFhsTpJqcLqoaWo5ZZ2NhFVPTEokMt39lc+Ls02NMkHrkra1c8ORySmubOry/yeli+/4apg3v7+fITF9jicCYIKSqLMsppbyuhe+/sQl3uzWEV+dX8uiirWwtrsbpUqalWSIwJ8cSgTFBKK+8ntLaZrIyBvDxzjJ++d4OPHM0wtNLd/H8ij08+cFOAKanWyIwJ8cGi40JQit2e2Zjf/zaafz50zz+8HEeTpfyjXNH8VluOQCf5VYwOCGa1IToQIZq+gBLBMYEoZW7KxiSGM2IpFh+PH8y4WFhPPdZPvnldbgVvnzmCP7y2R6mDU8MdKimD7BEYEyQcbuVlXkVnDMuBREB4EeXTiB7byXLcsoYPzieBy+ewPb9NVw21RaTNyfPxgiMCTJbiqupqG/hjFHJbWURjjCevO4UoiPCuGZmGpHhYbx65+lcfoyLx4zpKmsRGBNk/r62kKjwMC6cmHpY+djUeFY9eAHx0fZva3qWfaKMCSLNrS7e2lDMRZMGkxgTcdT9ibFHlxlzsqxryJgg8uG2UqobnVwzMy3QoZgQ0qVEICJvisilImKJwxgfemtDEYMTojlzdPLxKxvTQ7p6YH8GuAnYJSK/EBFb0cKYHuZ2K6vyKzlnbAqOMAl0OCaEdGmMQFU/BD4UkUTgRu/tAuCPwIuq6vRhjMb0WWW1zby9qZiM5DgGxUdR3ehk9siBgQ7LhJguDxaLSBJwC/AlYD3wEnAWcBtwri+CM6Yv21JUzVXPrqCl1U3/2AjuOnsUALNHJgU4MhNqujpG8E/gEyAWuFxV56nqa6r6bcAmQDfmBLyeXUCYwM+vmkJVg5MFy3IZPjCGYf1jAh2aCTFdHSN4SlUnqurPVXV/+ztUNcsHcRnTZ5TXNfPiyr1tk8YBuNzKO5tL+ML4Qdxw6nDGpcZT19zK7ExrDRj/62oimCgibVMcisgAEfnm8R4kInNFJEdEckXkgQ7uv11EykRkg/fnq92I3Zhe4aE3N/M//9pCQWVjW9mqvArK65q5bOpQRIRbz/AsNj8708YHjP91dYzga6q64NCGqh4Uka/hOZuoQyLiABYAFwKFwBoRWaSq246o+pqq3t3NuI3pFT72rikMUFbXTHpSLAD/3rSf2EgH540bBMA1M9NwtrptyggTEF1tETjk0OxXtB3kI4/zmFlArqrmqWoL8Cow/8TCNKZ3+tk724mNdACeLqJDPt9dzpwxycR474sKd3D7mZlERzgCEqcJbV1NBO8Br4nI+SJyPvCKt+xYhgEF7bYLvWVHulpENonI30VkeEdPJCJ3iki2iGSXlZV1MWRjAqu0pokdJbXcOCsdgIo6z/rDza0u9lU2MG5wQiDDM6ZNVxPBD4FlwDe8P0uAH/TA6/8bGKGqU4EPgL92VElVF6pqlqpmpaSk9MDLGtPzXlq1l7N+uZSNBVUArNt3EKBt8rhDLYI95Q24FUalxAUmUGOO0KVEoKpuVX1WVa/x/vxBVV3HeVgR0P4bfpq3rP3zVqjqofbyn4CZXQ3cmGCiqvzx4zwKDzZyw8KVrM6vZN2+KiIdYUxP709CdDgV3kSwu6wOgFEpdua1CQ5dvY5gjLfrZpuI5B36Oc7D1gBjRCRTRCKBG4BFRzzvkHab84Dt3QnemGCRvfcgeyoa+OHc8QyMi+TxxTtYt/cgk4YlEBXuIDk+inJv19DuUksEJrh09ayhvwCPAL8GzgO+zHGSiKq2isjdwGLAATynqltF5DEgW1UXAfeIyDygFagEbj+hv8KYAKludJJTUssrq/cRG+ng1tMziHAIP3l7O44w4fYzRgCQHBdFmbdFkFtWx7D+MW0DxcYEWlcTQYyqLhERUdW9wKMishZ4+FgPUtV3gHeOKHu43e0HgQe7GbMxQeOeV9azfKfnBIZrZ6YRFxXOtTOH88T7O2l0upiRPgCA5PhIckpqAU/X0OhB1howwaOriaDZOwX1Lu+3/CJsagkT4j7KKWX5zjJuOz2D1MRo5p/iOSkuMTaCK6YP45XV+5iR4bkOM7lfFJ/VVeB2K7tL65k1y64gNsGjq4ngXjzzDN0D/BhP99BtvgrKmGD2+e4KFm0s4pNd5WQkxfLQpROICj+8m+eBi8fzxYmpDEn0zBuUFOeZWXRfZQONThejBtkZQyZ4HDcReC8eu15Vvw/U4RkfMCYkNTldfO/1DRxscJISH8XPrpxyVBIASIyJ4Lzxg9q2k+M911+uzq8EYLQNFJsgctxEoKouETnLH8EYE+xeXrWP4uomXvrq7G6tIpYUFwXAu1v24wgTJgy1i8lM8Ohq19B6EVkEvAHUHypU1Td9EpUxQWhrcTXPfJTLGaOSur2UZIq3RfDxrnJOGd6fhGhbhN4Ej64mgmigAvhCuzIFLBGYPm9/dSP/t3gnb64vJDEmgocumdDt5zjUInC5lTljbD1iE1y6ulSljQuYkLSjpIYrF6zApcqdc0byzXNHkxjb/W/zyfFRbbctEZhg06VEICJ/wdMCOIyq3tHjERkTIG63EnbEovGPv5dDhEN4/56zGT4w9oSfOy7SQVR4GJGOMKal9T/+A4zxo65OOvcf4G3vzxIgAc8ZRMb0CR/vLGPaY+/zzub/LsC3du9Bluwo5a5zRp1UEgAQEdIGxDBnbDLhjq7+2xnjH13tGvpH+20ReQX41CcRGRMAf/o0n9qmVu5+eR2/vv4U5k0byi/f3UFyv8i2aSJO1l9un0W/6K4OyxnjPyf6qRwDDDpuLWN6gYLKBj7ZVcZdZ49kfUEV9/99E9uKa1i9p5JfXDWFuKieOXgfWp3MmGDT1TGCWg4fIyjBs0aBMb3eq2v2IcBtZ4zga+FhXPLbT/jDx3nMzBjAdVkdrpVkTJ/S1a6heF8HYkwg7K2o54XP93LeuEEM7e+ZDuJ3N83gsf9s5WdXTjlq8NiYvqir6xFcKSKJ7bb7i8gVvgvLGN9raGnlrhfWIiI8cvmktvJZmQP5z7fnMG6wff8xoaGrpy88oqrVhzZUtQrP+gTG9EpOl5u7X15PzoFanrpxuvXfm5DW1UTQUT07/cH0Sq0uNz/8xyaW7ijlx/Mnc85YWwfbhLauHsyzReRJYIF3+1vAWt+EZIzvNLa4+PYr6/hweyn3XTiWW07LCHRIxgRcV1sE3wZagNeAV4EmPMnAmKC3saCKJ97PAeDFlXv5cHspj82fxD3njwlwZMYEh66eNVQPPODjWIzxideyC3h51T6+dFoGGwurSBsQw62njwh0WMYEja6eNfSBiPRvtz1ARBb7Lixjek5emWc2lK3FNWzfX8OEIbYWgDHtdbVrKNl7phAAqnoQu7LY9BJ5ZZ4lNLL3VpJfXs8EOy3UmMN0NRG4RST90IaIjKCD2UiNCTa1TU5Ka5sB+Nf6YtyKtQiMOUJXzxr6EfCpiCwHBJgD3OmzqIzpIfnlntZAfHQ4RVWNgCUCY47UpRaBqr4HZAE5wCvA94BGH8ZlTI841C00d9JgwLMuQPpJTiltTF/T1cHir+JZh+B7wPeBF4BHfReWMT0jr6yOMIFLpg4BYNzgeJs/yJgjdHWM4F7gVGCvqp4HTAeqjv0QEJG5IpIjIrki0unppyJytYioiGR1MR5jumR3eT3DB8YyY/gAwLqFjOlIV8cImlS1SUQQkShV3SEi4471ABFx4LkS+UKgEFgjIotUddsR9eLxJJpVJxC/MceUV1bPyOQ4EmMj+L9rp5GVMSDQIRkTdLraIij0XkfwL+ADEXkL2Hucx8wCclU1T1Vb8FyRPL+Dej8GfonnamVjekyry01+eR0jU/oBcM3MNEYkxwU4KmOCT1evLL7Se/NREVkGJALvHedhw4CCdtuFwOz2FURkBjBcVd8Wkfs7eyIRuRPvWUrp6emdVTPmMH/8JJ8mp5szRycFOhRjglq3ZxBV1eU98cIiEgY8CdzehddcCCwEyMrKsusXzHHtPFDLrz/cydxJg/nC+NRAh2NMUOtq19CJKALar/OX5i07JB6YDHwkInuA04BFNmBsuqustpnr/vA5O0pqcLmVB9/cxCW//YSYCAePzZ90/CcwJsT5MhGsAcaISKaIRAI3AIsO3amq1aqarKojVHUEsBKYp6rZPozJ9BHFVY3c/pfVbCmq5tmPdrM6v5J/ri9i7d6DvLK6gCumD+Pte85iUEJ0oEM1Juj5bHEZVW0VkbuBxYADeE5Vt4rIY0C2qi469jMY07nfL9/NRzll5JbWUeadQuLTXeU4RAgPEx6+fCIJ0REBjtKY3sGnq4yp6jvAO0eUPdxJ3XN9GYvpO8rrmnltTQGnjhjA+n1VKHBdVhqvZxdS0+RkRsYASwLGdIMtN2l6nec/20OLy80vrp7KzpJaapqcjB+cwOvZhRRUNnLDqXZmmTHdYYnABLX91Y08+9Fuvn/ROBKiI1BV3lxXyHnjBjEqpR+jvNcIuNxK/9gIqhqcnDvO1iA2pjt8OVhszEl7edU+/vb5Xh58czOqyvb9tRRXN3HRpMNPCXWECeeOTWFoYjQTbRoJY7rFWgQmqDQ5XeSW1tHc6mZmxgDe33qAmAgHb2/az5zRyZTVNiNCh9cGPHbFZOqbWxGxSeWM6Q5LBCZoNLa4uPi3H7OnogGAx+ZPIudALf9z6QQ+yinj0X9vZVB8NNPS+pMSH3XU4xOiI2yQ2JgTYF1DJmj89fM97Klo4MdXTGZkchwPv7UVgLmTB/Pk9dPoFxXOvsoGLphgq6Qa05MsEZigUNPk5PfLd3PuuBS+dFoGP75iMgCThiaQNiCWQfHR/Pr6U0hNiOLSqUMDHK0xfYt1DZmg8OT7O6lqcPL9L3pmNz9zdDL/e9lERg/q11ZnzpgUVj10QaBCNKbPskRgAsbtVsrrmtlYWM3zK/Zw2+kZTB6W2Hb/V87KDGB0xoQOSwQmYJ5auovffLgLgHGp8Tx4yYQAR2RMaLJEYALC6XLz4sp9zEjvzyVTht6dlFsAABDrSURBVHDp1CFERzgCHZYxIckSgQmIJdsPUF7XzK+umWLrBRgTYHbWkAmIl1btY0hiNOeMtVNBjQk0SwTGr5qcLh7652Y+2VXOTbPScYTZVcDGBJolAuNXv/lwFy+v2sddZ4/k6+eOCnQ4xhgsERgfUlXyyupQ/e8y09l7KsnKGMCDl0wgwmEfP2OCgf0nGp8oq23mrhfW8oUnlvPvTfsBz1TR2/bXHHatgDEm8CwRmB7nditf/esaPtpZRlykgw+2HQBgT0U9DS0uJg21aaKNCSZ2+qjpMdUNTlyqfJRTysbCap64dhordlewZMcBXG5lS1E1AJOGWovAmGBiicD0iC1F1Xz5+TVUNziJCg9jaloiV04fRkR4GP9YV8jGwiq2FtcQ6QhjTGq/4z+hMcZvrGvInJTGFhcLP97N9X/4nIgw4ZqsNOKjw3l03iTCwoQ5o5MJE1ieU8bW4mrGDY63QWJjgoy1CMwJa3K6uPrZFWzbX8PZY1N4/JqppCZEH1ZnQFwk04b35/XsAmqbWrl82pAARWuM6Yx9NTMn7Bfv7mDb/hqeuXkGf7tj1lFJ4JD7vziOmAgHdc2tzMwY6OcojTHHYy0Cc0JeX1PA8yv2cPsZI7hkyrG/5Z8xOpkl3zuHgspG0gbE+ClCY0xXWSIw3dLc6uKpJbtYsGw3c8Yk88DF47v0OBEhPSnWx9EZY06EJQLTZTkltdz5QjZ7Kxq4dmYaP71yCpHh1rtoTG/n0/9iEZkrIjkikisiD3Rw/9dFZLOIbBCRT0Vkoi/jMSeutsnJXS9k09Di4m93zOLxa6dZEjCmj/DZf7KIOIAFwMXARODGDg70L6vqFFU9BfgV8KSv4jEnzuVWfvD3TRQcbGTBTTM4e2xKoEMyxvQgX36lmwXkqmqeqrYArwLz21dQ1Zp2m3GAYoKK0+Xm3lfX8+6WEh68eDyzMu2sH2P6Gl+OEQwDCtptFwKzj6wkIt8C7gMigS909EQicidwJ0B6enqPB2o698dP8vjPpv08dMl4vjpnZKDDMcb4QMA7eVV1gaqOAn4I/E8ndRaqapaqZqWkWLeEv7jdyiur93HGqCTuPNvWDjCmr/JlIigChrfbTvOWdeZV4AofxmM6cbC+hcr6FlbnV/I//9rMku2e2UJX5lVQUNnI9acOP84zGGN6M192Da0BxohIJp4EcANwU/sKIjJGVXd5Ny8FdmH8Kr+8not+/TEtLjcAYQIvrtzHdVlpFB5sJDEmgosmDQ5wlMYYX/JZIlDVVhG5G1gMOIDnVHWriDwGZKvqIuBuEbkAcAIHgdt8FY/p2DPLchGB/71sIokxEVw4MZXffLiTF1fuxelSvnzmCKIjHIEO0xjjQ9J+GcHeICsrS7OzswMdRq/W2OLi+RV7GDYghvte28Atp2Xw6LxJh9VpcrrILa1jVEo/YiItERjT24nIWlXN6ug+u7I4xNQ1t3LH82tYnV8JQIRDuOuco88Gio5w2JKSxoQISwQh5ruvbWDt3oM8ce00oiLCiA53MCTRJoIzJpRZIgghK/Mq+GDbAX4wdxxXz0wLdDjGmCAR8OsIjH80OV38/N0dDEmM5o4zMwMdjjEmiFiLoI9SVUQEgN9+uItnl+fS5HTzf9dOs7OAjDGHsUTQx+yvbuShNzeTvfcgszOTuPf8MfxmyU6+MG4Qd5yVyZmjkwMdojEmyFgi6GN+88EuPttdwTljU/hg2wFW5VcwIDaSJ68/hcSYiECHZ4wJQjZG0MvtKKlhf3UjAKW1TfxzfRHXZaWx8EszueHU4dQ2tfLdC8ZYEjDGdMpaBL3Y4q0lfPOldQB8cWIqrW7F6XbzlbNGIiI8Nn8yl08byukjkwIcqTEmmFki6KU+3VXO3S+vY8qwRLIyBvCvDcWU1zVzyZTBZCbHARAZHmZjAsaY47JE0Avtq2jgWy+vY2RyP/56xywSYyL40aUTKK5uIikuMtDhGWN6GUsEvcyGgiq+9/oGABbeOrOt719EGNbfrhA2xnSfDRYHKVXlrQ1F7DxQ21b2u6W7uGLBZ9Q2tfL7W2aSkRQXwAiNMX2FtQiC1NIdpdz7queb/+zMgaQPjOWNtYVcccpQfnLlFPpF2VtnjOkZdjQJQqrK00tzSRsQw42z0vnX+iJW5Vcyb9pQnrjuFBxhEugQjTF9iCWCIFJU1cgjb20lMSaCDQVV/PTKydw8O4NvnTeastpmkvtFtk0bYYwxPcUSgR+1utwUVzXhdLtJiI4gTKCp1U1No5OGFhf3vb6BAzVNtLqUYf1juKbdDKEp8VEBjNwY05dZIvCDkuomnl66izfWFtLS6u60Xlykg5e/dhpjBvXD7YaocJsczhjje5YIepjT5WZvRT2jB8UDsCynlHteWU+T08VV09OYkdGf6AgH1Y1OVCEqPIzEmAjCwoSJQxIYPjA2wH+BMSbUWCLoYc8s282vP9zJBRNSCQ8TFm8rYcLgBJ69ZYad7mmMCUqWCHqQqvLm+kKG9Y9hxe5yYiIcfG3OSL5zwRhiI21XG2OCkx2detCmwmr2VjTwq6unMu+UoYSHCeEOu2bPGBPcLBH0oEUbi4l0hHHR5MG2Cpgxptewr6s9ZMXucv65vohzxqXY3P/GmF7FEkEPeO7TfG764yriohzce/6YQIdjjDHd4tNEICJzRSRHRHJF5IEO7r9PRLaJyCYRWSIiGb6MxxdKa5t44v0czh2XwgffPYfJwxIDHZIxxnSLzxKBiDiABcDFwETgRhGZeES19UCWqk4F/g78ylfx+MoTi3fS4nLzyOWTbFzAGNMr+bJFMAvIVdU8VW0BXgXmt6+gqstUtcG7uRJIo5dwu5Un3s/htewCbj19RNuqYMYY09v48qyhYUBBu+1CYPYx6n8FeLejO0TkTuBOgPT09J6K74S1tLr57usbeHvTfq7LSuMHc8cFOiRjjDlhQXH6qIjcAmQB53R0v6ouBBYCZGVlqR9DO0xtk5PlO8t4bU0Bn+wq56FLxvO1OSNtRlBjTK/my0RQBAxvt53mLTuMiFwA/Ag4R1WbfRjPCSmrbaa60UlDSyvffGkdhQcbiY4Ia5si2hhjejtfJoI1wBgRycSTAG4AbmpfQUSmA38A5qpqqQ9j6ZYmp4tFG4p5afU+NhZUtZUPTojmxa/MZvbIgUTYFcPGmD7CZ4lAVVtF5G5gMeAAnlPVrSLyGJCtqouAx4F+wBve7pV9qjrPVzF1xe6yOr72t2zyyuoZlxrP9784lqH9Y6ioa2H+9KEMio8OZHjGGNPjfDpGoKrvAO8cUfZwu9sX+PL1j1R4sIGnluyiqKrxqPtUoaHFxc4DtcREOHju9izOGzfI+v+NMX1eUAwW+8Prawp4eNEWACYNTaSjw3t8dDiXTR3CvReMZVj/GP8GaIwxARIyiWBEchznj0/loUsn2EHeGGPaCZlEMCtzILMyBwY6DGOMCTp26osxxoQ4SwTGGBPiLBEYY0yIs0RgjDEhzhKBMcaEOEsExhgT4iwRGGNMiLNEYIwxIU5UAza9/wkRkTJg7wk+PBko78FwelKwxmZxdY/F1X3BGltfiytDVVM6uqPXJYKTISLZqpoV6Dg6EqyxWVzdY3F1X7DGFkpxWdeQMcaEOEsExhgT4kItESwMdADHEKyxWVzdY3F1X7DGFjJxhdQYgTHGmKOFWovAGGPMESwRGGNMiAuZRCAic0UkR0RyReSBAMYxXESWicg2EdkqIvd6yx8VkSIR2eD9uSQAse0Rkc3e18/2lg0UkQ9EZJf39wA/xzSu3T7ZICI1IvKdQO0vEXlOREpFZEu7sg73kXg85f3MbRKRGX6O63ER2eF97X+KSH9v+QgRaWy3737v57g6fe9E5EHv/soRkYt8FdcxYnutXVx7RGSDt9wv++wYxwfffsZUtc//AA5gNzASiAQ2AhMDFMsQYIb3djywE5gIPAp8P8D7aQ+QfETZr4AHvLcfAH4Z4PexBMgI1P4CzgZmAFuOt4+AS4B3AQFOA1b5Oa4vAuHe279sF9eI9vUCsL86fO+8/wcbgSgg0/s/6/BnbEfc/wTwsD/32TGODz79jIVKi2AWkKuqearaArwKzA9EIKq6X1XXeW/XAtuBYYGIpYvmA3/13v4rcEUAYzkf2K2qJ3pl+UlT1Y+ByiOKO9tH84G/qcdKoL+IDPFXXKr6vqq2ejdXAmm+eO3uxnUM84FXVbVZVfOBXDz/u36PTUQEuA54xVev30lMnR0ffPoZC5VEMAwoaLddSBAcfEVkBDAdWOUtutvbvHvO310wXgq8LyJrReROb1mqqu733i4BUgMQ1yE3cPg/ZqD31yGd7aNg+tzdgeeb4yGZIrJeRJaLyJwAxNPRexdM+2sOcEBVd7Ur8+s+O+L44NPPWKgkgqAjIv2AfwDfUdUa4FlgFHAKsB9Ps9TfzlLVGcDFwLdE5Oz2d6qnLRqQ841FJBKYB7zhLQqG/XWUQO6jzojIj4BW4CVv0X4gXVWnA/cBL4tIgh9DCsr37gg3cviXDr/usw6OD2188RkLlURQBAxvt53mLQsIEYnA8ya/pKpvAqjqAVV1qaob+CM+bBJ3RlWLvL9LgX96YzhwqKnp/V3q77i8LgbWqeoBb4wB31/tdLaPAv65E5HbgcuAm70HELxdLxXe22vx9MWP9VdMx3jvAr6/AEQkHLgKeO1QmT/3WUfHB3z8GQuVRLAGGCMimd5vljcAiwIRiLfv8c/AdlV9sl15+369K4EtRz7Wx3HFiUj8odt4Bhq34NlPt3mr3Qa85c+42jnsG1qg99cROttHi4BbvWd2nAZUt2ve+5yIzAV+AMxT1YZ25Ski4vDeHgmMAfL8GFdn790i4AYRiRKRTG9cq/0VVzsXADtUtfBQgb/2WWfHB3z9GfP1KHiw/OAZXd+JJ5P/KIBxnIWnWbcJ2OD9uQR4AdjsLV8EDPFzXCPxnLGxEdh6aB8BScASYBfwITAwAPssDqgAEtuVBWR/4UlG+wEnnv7Yr3S2j/CcybHA+5nbDGT5Oa5cPP3Hhz5nv/fWvdr7Hm8A1gGX+zmuTt874Efe/ZUDXOzv99Jb/jzw9SPq+mWfHeP44NPPmE0xYYwxIS5UuoaMMcZ0whKBMcaEOEsExhgT4iwRGGNMiLNEYIwxIc4SgTFeIuKSw2c67bFZar2zVwbyWgdjOhUe6ACMCSKNqnpKoIMwxt+sRWDMcXjnpf+VeNZqWC0io73lI0RkqXfytCUiku4tTxXP/P8bvT9neJ/KISJ/9M4z/76IxHjr3+Odf36TiLwaoD/ThDBLBMb8V8wRXUPXt7uvWlWnAL8DfuMtexr4q6pOxTOh21Pe8qeA5ao6Dc9891u95WOABao6CajCc7UqeOaXn+59nq/76o8zpjN2ZbExXiJSp6r9OijfA3xBVfO8E4KVqGqSiJTjmR7B6S3fr6rJIlIGpKlqc7vnGAF8oKpjvNs/BCJU9Sci8h5QB/wL+Jeq1vn4TzXmMNYiMKZrtJPb3dHc7raL/47RXYpnvpgZwBrv7JfG+I0lAmO65vp2vz/33l6BZyZbgJuBT7y3lwDfABARh4gkdvakIhIGDFfVZcAPgUTgqFaJMb5k3zyM+a8Y8S5W7vWeqh46hXSAiGzC863+Rm/Zt4G/iMj9QBnwZW/5vcBCEfkKnm/+38Azy2VHHMCL3mQhwFOqWtVjf5ExXWBjBMYch3eMIEtVywMdizG+YF1DxhgT4qxFYIwxIc5aBMYYE+IsERhjTIizRGCMMSHOEoExxoQ4SwTGGBPi/j89Es+EaUsdDAAAAABJRU5ErkJggg==\n"
          },
          "metadata": {
            "needs_background": "light"
          }
        }
      ],
      "source": [
        "import matplotlib.pyplot as plt\n",
        "\n",
        "def plot_graphs(history, string):\n",
        "  plt.plot(history.history[string])\n",
        "  plt.xlabel(\"Epochs\")\n",
        "  plt.ylabel(string)\n",
        "  plt.show()\n",
        "\n",
        "plot_graphs(history, 'accuracy')"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "upgJKV8_oRU9"
      },
      "source": [
        "### Varying the Possible Outputs\n",
        "\n",
        "In running the above, you may notice that the same seed text will generate similar outputs. This is because the code is currently always choosing the top predicted class as the next word. What if you wanted more variance in the output? \n",
        "\n",
        "Switching from `model.predict_classes` to `model.predict_proba` will get us all of the class probabilities. We can combine this with `np.random.choice` to select a given predicted output based on a probability, thereby giving a bit more randomness to our outputs."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 93,
      "metadata": {
        "id": "ee7WKgRGrJy1",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "9899179d-33d2-4276-a31e-37a258f443c7"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Грустный клоун на дворе бросили женою \n",
            " этот хорошо \n",
            " родили меня на прекрасны \n",
            " \n",
            " все так коленях продохнуть \n",
            " \n",
            " мне сгорела мной должен где забыть путь \n",
            " нашей двор \n",
            " \n",
            " в матери моя утром с карман \n",
            " этот я огне не деревне сгорела \n",
            " продохнуть \n",
            " путь \n",
            " родителям рожь все огне \n",
            " \n",
            " туман \n",
            " этот путь через с подыщи \n",
            " \n",
            " \n",
            " меня через веди интерес \n",
            " \n",
            " не орда \n",
            " приказы занесено \n",
            " святоши \n",
            " этот хорошо \n",
            " тобою в родной а \n",
            " все дома мир \n",
            " \n",
            " не видно где свернуть \n",
            " в забыть\n"
          ]
        }
      ],
      "source": [
        "# Use this process for the full output generation\n",
        "seed_text = \"Грустный клоун\"\n",
        "next_words = 100\n",
        "  \n",
        "for _ in range(next_words):\n",
        "  token_list = tokenizer.texts_to_sequences([seed_text])[0]\n",
        "  token_list = pad_sequences([token_list], maxlen=max_sequence_len-1, padding='pre')\n",
        "  predicted_probs = model.predict(token_list, verbose=0)[0]\n",
        "  predicted = np.random.choice([x for x in range(len(predicted_probs))],\n",
        "                               p=predicted_probs)\n",
        "  output_word = \"\"\n",
        "  for word, index in tokenizer.word_index.items():\n",
        "    if index == predicted:\n",
        "      output_word = word\n",
        "      break\n",
        "  seed_text += \" \" + output_word\n",
        "seed_text = seed_text.replace('endline', '\\n')\n",
        "print(seed_text)"
      ]
    }
  ],
  "metadata": {
    "accelerator": "GPU",
    "colab": {
      "name": "l10c04_nlp_optimizing_the_text_generation_model.ipynb",
      "toc_visible": true,
      "provenance": [],
      "include_colab_link": true
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}